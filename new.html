<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emmanuel Larbi | Future Tourism</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        neon: {
                            cyan: '#00f3ff',
                            purple: '#bc13fe',
                            bg: '#0a0a12',
                            card: '#12121f'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;600&display=swap');
        
        body {
            background-color: #050508;
            color: #e2e8f0;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(18, 18, 31, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .neon-border {
            position: relative;
        }
        .neon-border::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0%;
            height: 2px;
            background: linear-gradient(90deg, #00f3ff, #bc13fe);
            transition: width 0.3s ease;
        }
        .neon-border:hover::after {
            width: 100%;
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.5);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0a0a12;
        }
        ::-webkit-scrollbar-thumb {
            background: #1e1e2e;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #bc13fe;
        }

        .loader {
            border: 3px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            border-top: 3px solid #00f3ff;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="antialiased">

    <!-- Config & State -->
    <div id="app-state" data-user-email="" data-is-admin="false"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-white/5">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded bg-gradient-to-br from-neon-cyan to-neon-purple flex items-center justify-center text-black font-bold font-mono">EL</div>
                    <span class="font-bold tracking-wider text-lg">LARBI<span class="text-neon-cyan">.DEV</span></span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-8">
                        <a href="#home" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">Home</a>
                        <a href="#about" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">About</a>
                        <a href="#experience" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">Experience</a>
                        <a href="#gallery" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">Gallery</a>
                        <a href="#blog" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">Blog</a>
                        <a href="#contact" class="hover:text-neon-cyan transition-colors px-3 py-2 rounded-md text-sm font-medium neon-border">Contact</a>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button id="auth-btn" class="hidden text-xs bg-white/10 hover:bg-white/20 px-3 py-1 rounded border border-white/10 transition">Admin Login</button>
                    <div id="user-info" class="hidden text-xs text-gray-400 flex items-center gap-2"></div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="min-h-screen flex items-center justify-center relative overflow-hidden pt-16">
        <!-- Background Elements -->
        <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-neon-purple/20 rounded-full blur-[100px]"></div>
        <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-neon-cyan/10 rounded-full blur-[100px]"></div>

        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center gap-12">
            <div class="md:w-1/2 space-y-6 animate-float">
                <div class="inline-block px-3 py-1 rounded-full border border-neon-cyan/30 bg-neon-cyan/10 text-neon-cyan text-xs font-mono mb-2">
                    TOURISM MANAGEMENT & SUSTAINABILITY
                </div>
                <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight leading-tight">
                    Hello, I'm <br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-neon-cyan to-neon-purple neon-text">Emmanuel Larbi</span>
                </h1>
                <p class="text-gray-400 text-lg md:text-xl max-w-lg">
                    Applying futuristic frameworks in marketing, sustainability, and destination resilience. Building the future of tourism tech.
                </p>
                <div class="flex flex-wrap gap-4 pt-4">
                    <a href="resume2.pdf" target="_blank" class="px-8 py-3 bg-neon-cyan text-black font-bold rounded hover:bg-cyan-300 transition shadow-[0_0_20px_rgba(0,243,255,0.3)] flex items-center gap-2">
                        <i data-lucide="file-down" class="w-4 h-4"></i> Download CV
                    </a>
                    <a href="#contact" class="px-8 py-3 border border-white/20 hover:border-neon-purple hover:text-neon-purple transition rounded bg-white/5 backdrop-blur-sm">
                        Contact Me
                    </a>
                </div>
            </div>
            <div class="md:w-1/2 flex justify-center">
                <div class="relative w-80 h-80 md:w-96 md:h-96">
                    <div class="absolute inset-0 bg-gradient-to-br from-neon-cyan to-neon-purple rounded-full blur-2xl opacity-50 animate-pulse-slow"></div>
                    <img src="profilepic.png" onerror="this.src='https://api.dicebear.com/7.x/avataaars/svg?seed=Emmanuel&backgroundColor=b6e3f4'" alt="Emmanuel Larbi" class="relative w-full h-full object-cover rounded-2xl border-2 border-white/10 shadow-2xl glass-panel p-2">
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Panel (Hidden by default) -->
    <section id="admin-panel" class="hidden py-12 bg-red-900/10 border-y border-red-500/20">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-3xl font-bold text-red-400 flex items-center gap-2">
                    <i data-lucide="shield-alert"></i> Admin Dashboard
                </h2>
                <span class="text-xs text-gray-500 font-mono">AUTHORIZED: EMMANUEL LARBI</span>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Create Blog -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4 text-neon-cyan">Post New Blog</h3>
                    <form id="create-blog-form" class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Title</label>
                            <input type="text" id="blog-title" required class="w-full bg-black/50 border border-white/10 rounded p-2 focus:border-neon-cyan outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Image URL</label>
                            <input type="url" id="blog-image" placeholder="https://..." class="w-full bg-black/50 border border-white/10 rounded p-2 focus:border-neon-cyan outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Content</label>
                            <textarea id="blog-content" rows="4" required class="w-full bg-black/50 border border-white/10 rounded p-2 focus:border-neon-cyan outline-none text-white"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-neon-purple/80 hover:bg-neon-purple py-2 rounded text-white font-bold transition">Publish Post</button>
                    </form>
                </div>

                <!-- Messages Inbox -->
                <div class="glass-panel p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-4 text-neon-purple">Inbox Messages</h3>
                    <div id="admin-messages-list" class="space-y-3 max-h-96 overflow-y-auto pr-2">
                        <p class="text-gray-500 text-sm">Loading messages...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Experience & Education -->
    <section id="about" class="py-24 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold mb-4">Experience & <span class="text-neon-purple">Education</span></h2>
                <div class="h-1 w-20 bg-neon-purple mx-auto rounded-full"></div>
            </div>

            <div class="grid md:grid-cols-2 gap-12">
                <!-- Experience -->
                <div id="experience" class="space-y-8">
                    <h3 class="text-2xl font-bold flex items-center gap-2"><i data-lucide="briefcase" class="text-neon-cyan"></i> Experience</h3>
                    
                    <div class="glass-panel p-6 rounded-xl border-l-4 border-neon-cyan transform hover:-translate-y-1 transition duration-300">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="text-xl font-bold text-white">Administrative Assistant</h4>
                            <span class="text-xs bg-neon-cyan/20 text-neon-cyan px-2 py-1 rounded">2026 - Present</span>
                        </div>
                        <p class="text-gray-400 font-mono text-sm mb-2">AZ LEARNER</p>
                        <p class="text-gray-300 text-sm">Coordinating internal logistics and resource scheduling. Applying structured organizational skills aligning with tour operations and tourism tech.</p>
                    </div>

                    <div class="glass-panel p-6 rounded-xl border-l-4 border-neon-purple transform hover:-translate-y-1 transition duration-300">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="text-xl font-bold text-white">Communications and PR</h4>
                            <span class="text-xs bg-neon-purple/20 text-neon-purple px-2 py-1 rounded">2025 - 2026</span>
                        </div>
                        <p class="text-gray-400 font-mono text-sm mb-2">YOM HEALTH</p>
                        <p class="text-gray-300 text-sm">Developing and disseminating clear, engaging messaging across digital channels to enhance brand visibility.</p>
                    </div>

                    <div class="glass-panel p-6 rounded-xl border-l-4 border-white/20 transform hover:-translate-y-1 transition duration-300">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="text-xl font-bold text-white">Coordinator</h4>
                            <span class="text-xs bg-white/10 text-gray-300 px-2 py-1 rounded">2025 - 2026</span>
                        </div>
                        <p class="text-gray-400 font-mono text-sm mb-2">PENSA</p>
                        <p class="text-gray-300 text-sm">Planned and executed campus events, managing timelines, resources, and volunteer teams.</p>
                    </div>
                </div>

                <!-- Education & Skills -->
                <div class="space-y-8">
                    <h3 class="text-2xl font-bold flex items-center gap-2"><i data-lucide="graduation-cap" class="text-neon-purple"></i> Education</h3>
                    
                    <div class="glass-panel p-6 rounded-xl relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-20 h-20 bg-neon-purple/10 rounded-bl-full"></div>
                        <h4 class="text-xl font-bold text-white">BSc. Tourism Management</h4>
                        <p class="text-neon-cyan text-sm mb-1">University of Cape Coast</p>
                        <p class="text-gray-500 text-xs mb-4">2025 - Present</p>
                        <p class="text-gray-300 text-sm">Focus on destination resilience, visitor management, and sustainability frameworks.</p>
                    </div>

                    <div class="glass-panel p-6 rounded-xl">
                        <h4 class="text-xl font-bold text-white">General Arts</h4>
                        <p class="text-neon-purple text-sm mb-1">Benkum Senior High School</p>
                        <p class="text-gray-500 text-xs">2021 - 2023</p>
                    </div>

                    <!-- Skills -->
                    <div class="mt-8">
                        <h3 class="text-2xl font-bold flex items-center gap-2 mb-4"><i data-lucide="cpu" class="text-white"></i> Skills</h3>
                        <div class="flex flex-wrap gap-2">
                            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-sm text-gray-300">Public Speaking</span>
                            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-sm text-gray-300">Branding</span>
                            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-sm text-gray-300">Project Management</span>
                            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-sm text-gray-300">Communication</span>
                            <span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-sm text-gray-300">Resource Scheduling</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery" class="py-20 bg-black/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold mb-8 text-center">Visual <span class="text-neon-cyan">Gallery</span></h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Gallery Item 1 -->
                <div class="group relative aspect-video overflow-hidden rounded-xl glass-panel">
                    <img src="gallery1.png" onerror="this.src='https://images.unsplash.com/photo-1544642899-f0d6e5f6ed6f?q=80&w=800&auto=format&fit=crop'" alt="Event" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                        <span class="text-neon-cyan font-mono border border-neon-cyan px-4 py-2 rounded">Tourism Event</span>
                    </div>
                </div>
                <!-- Gallery Item 2 -->
                <div class="group relative aspect-video overflow-hidden rounded-xl glass-panel">
                    <img src="gallery2.png" onerror="this.src='https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?q=80&w=800&auto=format&fit=crop'" alt="Speaking" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                        <span class="text-neon-purple font-mono border border-neon-purple px-4 py-2 rounded">Public Speaking</span>
                    </div>
                </div>
                <!-- Gallery Item 3 -->
                <div class="group relative aspect-video overflow-hidden rounded-xl glass-panel">
                    <img src="gallery3.png" onerror="this.src='https://images.unsplash.com/photo-1531403009284-440f080d1e12?q=80&w=800&auto=format&fit=crop'" alt="Team" class="w-full h-full object-cover transition duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                        <span class="text-white font-mono border border-white px-4 py-2 rounded">Team Coordination</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="py-24 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold mb-12 text-center">Latest <span class="text-neon-purple">Insights</span></h2>
            
            <div id="blog-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Blog posts injected here via JS -->
                <div class="col-span-full text-center text-gray-500 py-10">
                    <div class="loader mx-auto mb-2"></div>
                    Loading insights from the future...
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-24 bg-gradient-to-t from-neon-purple/5 to-transparent">
        <div class="max-w-3xl mx-auto px-4">
            <div class="glass-panel p-8 md:p-12 rounded-2xl border border-white/10 relative overflow-hidden">
                <div class="absolute -top-10 -right-10 w-32 h-32 bg-neon-cyan/20 rounded-full blur-3xl"></div>
                
                <h2 class="text-3xl font-bold mb-6 text-center">Send a Message</h2>
                <p class="text-center text-gray-400 mb-8">Connect for collaborations, sustainable tourism projects, or just a chat.</p>
                
                <form id="contact-form" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Name</label>
                            <input type="text" id="contact-name" required class="w-full bg-black/30 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-neon-purple focus:ring-1 focus:ring-neon-purple outline-none transition">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                            <input type="email" id="contact-email" required class="w-full bg-black/30 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-neon-purple focus:ring-1 focus:ring-neon-purple outline-none transition">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Message</label>
                        <textarea id="contact-message" rows="4" required class="w-full bg-black/30 border border-white/10 rounded-lg px-4 py-3 text-white focus:border-neon-purple focus:ring-1 focus:ring-neon-purple outline-none transition"></textarea>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-neon-purple to-pink-600 hover:from-neon-purple/80 hover:to-pink-600/80 text-white font-bold py-4 rounded-lg transition transform hover:scale-[1.01] shadow-lg">
                        Transmit Message
                    </button>
                </form>

                <div class="mt-10 flex justify-center gap-6">
                    <a href="https://www.linkedin.com/in/emanuel-larbi-88311a3a6" target="_blank" class="text-gray-400 hover:text-white transition"><i data-lucide="linkedin"></i></a>
                    <a href="mailto:emmanuel.larbi005@stu.ucc.edu.gh" class="text-gray-400 hover:text-white transition"><i data-lucide="mail"></i></a>
                    <a href="www.azlearner.me/emmanuel.html" target="_blank" class="text-gray-400 hover:text-white transition"><i data-lucide="globe"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-8 border-t border-white/5 text-center text-gray-600 text-sm">
        <p>© 2026 Emmanuel Larbi. All rights reserved.</p>
        <p class="mt-2 text-xs">UCC Tourism Management • Central Region, Ghana</p>
    </footer>

    <!-- Custom Modal for Notifications -->
    <div id="modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center bg-black/80 backdrop-blur-sm px-4">
        <div class="glass-panel p-8 rounded-xl max-w-sm w-full text-center border border-white/20 shadow-2xl transform scale-95 opacity-0 transition-all duration-300" id="modal-content">
            <div id="modal-icon" class="mx-auto w-12 h-12 rounded-full bg-neon-cyan/20 text-neon-cyan flex items-center justify-center mb-4">
                <i data-lucide="check"></i>
            </div>
            <h3 id="modal-title" class="text-xl font-bold mb-2">Success</h3>
            <p id="modal-msg" class="text-gray-400 mb-6">Action completed successfully.</p>
            <button onclick="closeModal()" class="px-6 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-white transition">Close</button>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signInAnonymously, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, updateDoc, doc, arrayUnion, arrayRemove, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- Configuration ---
        const firebaseConfig = {
            apiKey: "AIzaSyB6lxgjNY4CRNHAe3pAgR5SYv1ohL8brOI",
            authDomain: "francis-pwavwe.firebaseapp.com",
            projectId: "francis-pwavwe",
            storageBucket: "francis-pwavwe.firebasestorage.app",
            messagingSenderId: "658069378543",
            appId: "1:658069378543:web:87b1dcb0dd27d3255bd21a"
        };

        const ADMIN_EMAIL = "emmanuel.larbi005@stu.ucc.edu.gh";
        // To allow local testing if email doesn't match exactly, you can add your own email here during dev
        // const DEV_EMAIL = "your.email@gmail.com"; 

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = "1:658069378543:web:87b1dcb0dd27d3255bd21a"; // Using AppID as unique identifier for paths

        // --- Auth State Management ---
        const authBtn = document.getElementById('auth-btn');
        const userInfo = document.getElementById('user-info');
        const adminPanel = document.getElementById('admin-panel');
        const appState = document.getElementById('app-state');

        // Initial Auth Check
        onAuthStateChanged(auth, (user) => {
            authBtn.classList.remove('hidden');
            
            if (user) {
                // User is logged in
                console.log("User logged in:", user.email || "Anonymous");
                
                if (user.isAnonymous) {
                    authBtn.textContent = "Admin Login";
                    authBtn.onclick = loginWithGoogle;
                    userInfo.classList.add('hidden');
                    adminPanel.classList.add('hidden');
                } else {
                    // Actual user
                    authBtn.textContent = "Logout";
                    authBtn.onclick = () => signOut(auth);
                    userInfo.textContent = `Hi, ${user.displayName?.split(' ')[0]}`;
                    userInfo.classList.remove('hidden');
                    
                    // Check if Admin
                    if (user.email === ADMIN_EMAIL) {
                        appState.dataset.isAdmin = "true";
                        adminPanel.classList.remove('hidden');
                        loadAdminMessages(); // Load messages only if admin
                        userInfo.innerHTML += ' <span class="text-neon-cyan text-xs border border-neon-cyan px-1 rounded">ADMIN</span>';
                    }
                }
            } else {
                // No user, sign in anonymously for public read access if needed, or just wait
                signInAnonymously(auth).catch(console.error);
                authBtn.textContent = "Admin Login";
                authBtn.onclick = loginWithGoogle;
            }
        });

        function loginWithGoogle() {
            const provider = new GoogleAuthProvider();
            signInWithPopup(auth, provider).catch((error) => {
                showModal("Error", "Login failed: " + error.message, "alert-circle");
            });
        }

        // --- Firestore Logic: Blogs (Public) ---
        // Path: /artifacts/{appId}/public/data/blogs
        const blogsCollection = collection(db, 'artifacts', appId, 'public', 'data', 'blogs');

        // Real-time Blog Listener
        // Note: Simple query, sorting in JS to avoid index errors if not set up
        onSnapshot(blogsCollection, (snapshot) => {
            const container = document.getElementById('blog-container');
            container.innerHTML = '';

            let blogs = [];
            snapshot.forEach(doc => {
                blogs.push({ id: doc.id, ...doc.data() });
            });

            // Sort by timestamp desc (newest first)
            blogs.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));

            if (blogs.length === 0) {
                container.innerHTML = `<div class="col-span-full text-center text-gray-500 py-10">No insights published yet.</div>`;
                return;
            }

            blogs.forEach(blog => {
                const card = document.createElement('div');
                card.className = "glass-panel rounded-xl overflow-hidden flex flex-col hover:shadow-[0_0_20px_rgba(188,19,254,0.2)] transition duration-300";
                
                const img = blog.imageUrl ? `<img src="${blog.imageUrl}" class="w-full h-48 object-cover" alt="${blog.title}">` : `<div class="w-full h-48 bg-gradient-to-br from-gray-800 to-black flex items-center justify-center"><i data-lucide="image" class="w-8 h-8 text-gray-600"></i></div>`;
                
                // Comments preview (limit to 2)
                const comments = blog.comments || [];
                const commentsHtml = comments.slice(-2).map(c => `<div class="text-xs text-gray-400 mt-1 border-l-2 border-white/10 pl-2"><span class="text-neon-cyan">${c.user}:</span> ${c.text}</div>`).join('');

                card.innerHTML = `
                    ${img}
                    <div class="p-6 flex-1 flex flex-col">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs text-neon-purple border border-neon-purple/30 px-2 py-0.5 rounded">${new Date(blog.timestamp?.toDate()).toLocaleDateString()}</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2 text-white leading-tight">${blog.title}</h3>
                        <p class="text-gray-400 text-sm mb-4 flex-1">${blog.content}</p>
                        
                        <div class="border-t border-white/10 pt-4 mt-auto">
                            <div class="flex items-center justify-between mb-4">
                                <button class="like-btn flex items-center gap-1 text-sm text-gray-400 hover:text-pink-500 transition" data-id="${blog.id}">
                                    <i data-lucide="heart" class="w-4 h-4 ${blog.likes?.includes(auth.currentUser?.uid) ? 'fill-pink-500 text-pink-500' : ''}"></i>
                                    <span>${blog.likes ? blog.likes.length : 0}</span>
                                </button>
                                <span class="text-xs text-gray-500">${comments.length} Comments</span>
                            </div>
                            
                            <div class="space-y-2 mb-3 max-h-24 overflow-y-auto custom-scrollbar">
                                ${commentsHtml}
                            </div>

                            <form class="comment-form flex gap-2" data-id="${blog.id}">
                                <input type="text" placeholder="Add a comment..." class="bg-black/30 w-full text-xs rounded px-2 py-1 text-white border border-white/10 focus:border-neon-cyan outline-none">
                                <button type="submit" class="text-neon-cyan hover:text-white"><i data-lucide="send" class="w-4 h-4"></i></button>
                            </form>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            lucide.createIcons();

            // Attach listeners to dynamic elements
            document.querySelectorAll('.like-btn').forEach(btn => {
                btn.addEventListener('click', (e) => handleLike(e.currentTarget.dataset.id));
            });
            document.querySelectorAll('.comment-form').forEach(form => {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const input = form.querySelector('input');
                    handleComment(form.dataset.id, input.value);
                    input.value = '';
                });
            });
        });

        // --- Interactions (Like/Comment) ---
        async function handleLike(blogId) {
            if (!auth.currentUser) return showModal("Login Required", "Please login to like posts.", "lock");
            
            const blogRef = doc(db, 'artifacts', appId, 'public', 'data', 'blogs', blogId);
            // This is a simplified toggle. Ideally, read document first or use transaction.
            // Since we can't easily check arrayContains in a strict write rule without reading, 
            // we'll rely on the UI state or try to add, if fails (already exists), remove. 
            // BUT simpler logic: just try to add. If we want toggle, we need to read 'likes' array from the snapshot data we already have in memory?
            // Yes, let's use the local logic for smoother UI, but for correctness with Firestore:
            
            // Note: Efficient way without transaction for this demo:
            // We just use arrayUnion. If user clicks again, we could use arrayRemove. 
            // To know which one, we look at the button class we just rendered.
            const btn = document.querySelector(`.like-btn[data-id="${blogId}"] i`);
            const isLiked = btn.classList.contains('fill-pink-500');

            if (isLiked) {
                await updateDoc(blogRef, { likes: arrayRemove(auth.currentUser.uid) });
            } else {
                await updateDoc(blogRef, { likes: arrayUnion(auth.currentUser.uid) });
            }
        }

        async function handleComment(blogId, text) {
            if (!text.trim()) return;
            // Allow anonymous comments? Sure.
            const userName = auth.currentUser && !auth.currentUser.isAnonymous ? auth.currentUser.displayName : "Guest";
            
            const blogRef = doc(db, 'artifacts', appId, 'public', 'data', 'blogs', blogId);
            const newComment = {
                text: text,
                user: userName,
                timestamp: new Date().toISOString()
            };

            await updateDoc(blogRef, {
                comments: arrayUnion(newComment)
            });
        }

        // --- Admin Functions ---
        
        // 1. Create Blog
        document.getElementById('create-blog-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            if (appState.dataset.isAdmin !== "true") return;

            const title = document.getElementById('blog-title').value;
            const content = document.getElementById('blog-content').value;
            const image = document.getElementById('blog-image').value;

            try {
                await addDoc(blogsCollection, {
                    title,
                    content,
                    imageUrl: image,
                    timestamp: new Date(),
                    likes: [],
                    comments: []
                });
                showModal("Published", "Blog post live.", "check");
                e.target.reset();
            } catch (err) {
                showModal("Error", "Could not publish: " + err.message, "alert-circle");
            }
        });

        // 2. Read Messages (Admin Only)
        // Path: /artifacts/{appId}/public/data/messages
        // Using public path so admin can read ALL messages from various users easily.
        const messagesCollection = collection(db, 'artifacts', appId, 'public', 'data', 'messages');

        function loadAdminMessages() {
            onSnapshot(messagesCollection, (snapshot) => {
                const list = document.getElementById('admin-messages-list');
                list.innerHTML = '';
                
                let msgs = [];
                snapshot.forEach(doc => msgs.push(doc.data()));
                msgs.sort((a,b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));

                if(msgs.length === 0) {
                    list.innerHTML = '<p class="text-gray-500 text-sm">No messages yet.</p>';
                    return;
                }

                msgs.forEach(msg => {
                    const item = document.createElement('div');
                    item.className = "bg-black/40 p-3 rounded border border-white/5";
                    item.innerHTML = `
                        <div class="flex justify-between text-xs text-neon-cyan mb-1">
                            <span>${msg.name}</span>
                            <span>${new Date(msg.timestamp?.toDate()).toLocaleDateString()}</span>
                        </div>
                        <div class="text-xs text-gray-400 mb-1">${msg.email}</div>
                        <p class="text-sm text-gray-200">${msg.message}</p>
                    `;
                    list.appendChild(item);
                });
            });
        }

        // --- Contact Form (Public Write) ---
        document.getElementById('contact-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('contact-name').value;
            const email = document.getElementById('contact-email').value;
            const message = document.getElementById('contact-message').value;

            try {
                // Ensure auth (even anonymous)
                if (!auth.currentUser) await signInAnonymously(auth);

                await addDoc(messagesCollection, {
                    name,
                    email,
                    message,
                    timestamp: new Date(),
                    uid: auth.currentUser.uid
                });
                
                showModal("Sent", "Message transmitted to Emmanuel.", "send");
                e.target.reset();
            } catch (err) {
                showModal("Error", "Transmission failed: " + err.message, "wifi-off");
            }
        });

    </script>

    <!-- UI Scripts -->
    <script>
        // Modal Logic
        function showModal(title, msg, iconName) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            document.getElementById('modal-title').innerText = title;
            document.getElementById('modal-msg').innerText = msg;
            
            // Reset icon
            const iconContainer = document.getElementById('modal-icon');
            iconContainer.innerHTML = `<i data-lucide="${iconName}"></i>`;
            lucide.createIcons();

            modal.classList.remove('hidden');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        // Initialize Icons
        lucide.createIcons();

        // Canvas/Animation helper if needed later
        window.addEventListener('load', () => {
            document.body.classList.add('loaded');
        });
    </script>
</body>
</html>
